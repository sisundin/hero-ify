{"ast":null,"code":"import React from \"react\";\nimport { heroApihost, HeroApiAccessKey, firebaseConfig } from \"./apiConfig\";\nimport firebase from \"firebase\";\nimport Spotify from 'spotify-web-api-js';\nconst spotifyApi = new Spotify();\n\nclass HeroIfyModel extends React.Component {\n  constructor() {\n    super();\n    const params = this.getHashParams();\n    this.subscribers = [];\n    this.hero = {\n      name: \"You need to pick a hero!\",\n      image: {\n        lg: \"no image\"\n      }\n    };\n    this.playlistAttributes = {\n      userID: \"\",\n      genres: [],\n      pepLevel: \"\"\n    };\n    firebase.initializeApp(firebaseConfig);\n    this.db = firebase.database();\n\n    if (params.access_token) {\n      spotifyApi.setAccessToken(params.access_token);\n    }\n\n    this.state = {\n      loggedIn: params.access_token ? true : false\n    };\n  }\n\n  addObserver(callback) {\n    this.subscribers.push(callback);\n  }\n\n  removeObserver(callback) {\n    callback = this.subscribers.filter(o => o !== callback);\n  }\n\n  notifyObservers(whatHappened) {\n    this.subscribers.forEach(function (callback) {\n      callback(whatHappened);\n    });\n  }\n\n  getHeroData(string) {\n    return fetch(\"https://superhero-search.p.rapidapi.com/?\" + string, {\n      \"method\": \"GET\",\n      \"headers\": {\n        \"x-rapidapi-host\": heroApihost,\n        \"x-rapidapi-key\": HeroApiAccessKey\n      }\n    }).then(response => this.handleHTTPError(response)).then(response => response.json()).catch(error => console.log(error)); ///const http = new XMLHttpRequest();\n    ///http.open(\"GET\", heroApiENDPOINT+HeroApiAccessToken+string);\n    ///http.send();\n    ///http.onload = () => console.log(http.responseText)\n    /// return fetch(heroApiENDPOINT+HeroApiAccessToken+string, {\n    ///    \"method\": \"GET\",\n    ///    }).then(response => this.handleHTTPError(response))\n    ///.then(response => response.json()).then(response => console.log(response))\n    ///.catch(error => console.log(error));\n  }\n\n  handleHTTPError(response) {\n    if (response.ok) {\n      return response;\n    }\n\n    throw Error(response.statusText);\n  } /// Sök bara på namn i en sträng\n\n\n  searchHero(name) {\n    let data = this.getHeroData(\"hero=\" + name);\n    console.log(data);\n    return data;\n  } /// Sök bara på id i en sträng\n\n\n  getHeronID(id) {\n    let data = this.getHeroData(\"id=\" + id);\n    return data;\n  }\n\n  setHero(hero) {\n    this.hero = hero;\n    this.notifyObservers(\"hero was added\");\n  }\n\n  getHeroName() {\n    return this.hero.name;\n  }\n\n  getHeroId() {\n    return this.hero.id;\n  }\n\n  getHeroImage() {\n    return this.hero.image.lh;\n  }\n\n  heroGenres(powerstats) {\n    /// powerstats = {\"intelligence\":\"81\",\"strength\":\"40\",\"speed\":\"29\",\"durability\":\"55\",\"power\":\"63\",\"combat\":\"90\"};\n    let allstats = powerstats.intelligence + powerstats.strength + powerstats.speed + powerstats.durability + powerstats.combat;\n    let genres = {\n      \"classical\": powerstats.intelligence / allstats,\n      \"punk\": powerstats.strength / allstats,\n      \"pop\": powerstats.speed / allstats,\n      \"lowfy beats\": powerstats.durability / allstats,\n      \"electronic dance\": powerstats.power / allstats,\n      \"hip hop\": powerstats.combat / allstats\n    };\n    return genres;\n  } //getPlaylists NEEDS RENDER PROMIS\n\n\n  getOthersPlaylistsfromdatabase(limit = 5) {\n    let playlists = [];\n    return this.db.ref(\"UserGenereatedPlaylists\").limitToLast(limit).once('value').then(snapshot => {\n      snapshot = snapshot.toJSON();\n      Object.values(snapshot).reverse().forEach(doc => {\n        playlists.push({\n          Hero: doc.Hero,\n          PlaylistLink: doc.PlaylistLink,\n          User: doc.User\n        });\n      });\n      return playlists;\n    });\n  } //add a playlist to firebase\n\n\n  addYourplaylistToDatabase(heroname, playlistlink, user) {\n    this.db.ref(\"UserGenereatedPlaylists/\" + user).set({\n      Hero: heroname,\n      PlaylistLink: playlistlink,\n      User: user\n    });\n  } //spotify playlist function\n\n\n  spotifyApiConnect() {} //generates a link to create spotify playlist from\n\n\n  generateSpotifyPlaylist() {}\n\n  getHashParams() {\n    var hashParams = {};\n    var e,\n        r = /([^&;=]+)=?([^&;]*)/g,\n        q = window.location.hash.substring(1);\n    e = r.exec(q);\n\n    while (e) {\n      hashParams[e[1]] = decodeURIComponent(e[2]);\n      e = r.exec(q);\n    }\n\n    return hashParams;\n  }\n\n  getMyTopTracks() {\n    var alltrackstoptracks = [];\n    spotifyApi.getMyTopTracks({\n      limit: 100\n    }).then(response => {\n      for (var i = 0, l = response.items.length; i < l; i++) {\n        alltrackstoptracks.push(response.items[i]);\n      }\n    });\n    return alltrackstoptracks;\n  }\n\n}\n\nconst heroifyModel = new HeroIfyModel();\nexport default heroifyModel;","map":{"version":3,"sources":["/Users/simonsundin/Documents/GitHub/hero-ify/src/modelandconfig/model.js"],"names":["React","heroApihost","HeroApiAccessKey","firebaseConfig","firebase","Spotify","spotifyApi","HeroIfyModel","Component","constructor","params","getHashParams","subscribers","hero","name","image","lg","playlistAttributes","userID","genres","pepLevel","initializeApp","db","database","access_token","setAccessToken","state","loggedIn","addObserver","callback","push","removeObserver","filter","o","notifyObservers","whatHappened","forEach","getHeroData","string","fetch","then","response","handleHTTPError","json","catch","error","console","log","ok","Error","statusText","searchHero","data","getHeronID","id","setHero","getHeroName","getHeroId","getHeroImage","lh","heroGenres","powerstats","allstats","intelligence","strength","speed","durability","combat","power","getOthersPlaylistsfromdatabase","limit","playlists","ref","limitToLast","once","snapshot","toJSON","Object","values","reverse","doc","Hero","PlaylistLink","User","addYourplaylistToDatabase","heroname","playlistlink","user","set","spotifyApiConnect","generateSpotifyPlaylist","hashParams","e","r","q","window","location","hash","substring","exec","decodeURIComponent","getMyTopTracks","alltrackstoptracks","i","l","items","length","heroifyModel"],"mappings":"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","sourcesContent":["import React  from \"react\";\nimport {heroApihost, HeroApiAccessKey, firebaseConfig} from \"./apiConfig\"\nimport firebase from \"firebase\";\nimport Spotify from 'spotify-web-api-js'\nconst spotifyApi = new Spotify()\n\nclass HeroIfyModel extends React.Component {\n  constructor () {\n    super()\n    const params = this.getHashParams();\n    this.subscribers = [];\n    this.hero = {name:\"You need to pick a hero!\", image:{lg:\"no image\"}};\n    this.playlistAttributes = {userID:\"\", genres: [], pepLevel:\"\"};\n    firebase.initializeApp(firebaseConfig);\n    this.db = firebase.database();\n\n    if (params.access_token) {\n      spotifyApi.setAccessToken(params.access_token)\n    }\n    this.state = {\n        loggedIn: params.access_token? true : false,\n    } \n}\n\n  addObserver (callback) {\n    this.subscribers.push(callback)\n  }\n\n    removeObserver (callback) {\n    callback = this.subscribers.filter(o => o !== callback);\n    };\n   \n    notifyObservers(whatHappened){\n        this.subscribers.forEach(function(callback){ \n            callback(whatHappened);\n       });\n    }\n\n       \n    getHeroData(string) {\n        return fetch(\"https://superhero-search.p.rapidapi.com/?\"+string, {\n            \"method\": \"GET\",\n            \"headers\": {\n                \"x-rapidapi-host\": heroApihost,\n                \"x-rapidapi-key\": HeroApiAccessKey\n            }\n        }).then(response => this.handleHTTPError(response))\n        .then(response => response.json())\n        .catch(error => console.log(error));\n        \n\n\n        ///const http = new XMLHttpRequest();\n        ///http.open(\"GET\", heroApiENDPOINT+HeroApiAccessToken+string);\n        ///http.send();\n\n        ///http.onload = () => console.log(http.responseText)\n       /// return fetch(heroApiENDPOINT+HeroApiAccessToken+string, {\n        ///    \"method\": \"GET\",\n        ///    }).then(response => this.handleHTTPError(response))\n        ///.then(response => response.json()).then(response => console.log(response))\n        ///.catch(error => console.log(error));\n         \n    }\n\n    handleHTTPError(response) {\n        if(response.ok){\n           return response;}\n        throw Error(response.statusText);\n      }\n    /// Sök bara på namn i en sträng\n    searchHero(name){\n        let data = this.getHeroData(\"hero=\" + name);\n        console.log(data);\n        return data;\n    }\n    /// Sök bara på id i en sträng\n    getHeronID(id){\n        let data = this.getHeroData(\"id=\" + id);\n        return data;\n    }\n\n    setHero(hero){\n    \n        this.hero = hero;\n        this.notifyObservers(\"hero was added\");\n    }\n\n    getHeroName(){\n        return this.hero.name;\n    }\n\n    getHeroId(){\n        return this.hero.id;\n    }\n    getHeroImage(){\n        return this.hero.image.lh\n    }\n\n    heroGenres(powerstats){\n        /// powerstats = {\"intelligence\":\"81\",\"strength\":\"40\",\"speed\":\"29\",\"durability\":\"55\",\"power\":\"63\",\"combat\":\"90\"};\n        let allstats = powerstats.intelligence + powerstats.strength + powerstats.speed + powerstats.durability + powerstats.combat;\n        let genres = { \"classical\": powerstats.intelligence/allstats, \"punk\":powerstats.strength/allstats, \"pop\": powerstats.speed/allstats , \"lowfy beats\": powerstats.durability/allstats, \"electronic dance\": powerstats.power/allstats, \"hip hop\": powerstats.combat/allstats};\n        return genres;\n    }\n\n    //getPlaylists NEEDS RENDER PROMIS\n    getOthersPlaylistsfromdatabase(limit=5){\n        let playlists = [];\n        return this.db.ref(\"UserGenereatedPlaylists\").limitToLast(limit).once('value').then((snapshot) => {\n            snapshot = snapshot.toJSON();\n            Object.values(snapshot).reverse().forEach((doc) => {\n                playlists.push({Hero: doc.Hero, PlaylistLink:doc.PlaylistLink, User:doc.User})\n            })\n            return playlists;\n        })\n        \n        \n    }\n\n    //add a playlist to firebase\n    addYourplaylistToDatabase(heroname, playlistlink, user){\n        this.db.ref(\"UserGenereatedPlaylists/\"+user).set({\n            Hero: heroname,\n            PlaylistLink: playlistlink,\n            User: user\n            });\n}\n    \n   //spotify playlist function\n    spotifyApiConnect(){\n\n    }\n    //generates a link to create spotify playlist from\n    generateSpotifyPlaylist(){\n\n    }\n\n    getHashParams () {\n        var hashParams = {}\n        var e, r = /([^&;=]+)=?([^&;]*)/g,\n        q = window.location.hash.substring(1)\n        e = r.exec(q)\n        while (e) {\n          hashParams[e[1]] = decodeURIComponent(e[2])\n          e = r.exec(q)\n        }\n        return hashParams\n      }\n\n    getMyTopTracks () {\n        var alltrackstoptracks = []\n        spotifyApi.getMyTopTracks({ limit: 100 }).then(response => {\n            for (var i = 0, l = response.items.length; i < l; i++) {\n            alltrackstoptracks.push(response.items[i])\n            }\n        })\n        return alltrackstoptracks\n\n        }\n    \n    \n}\n\n\n\n\nconst heroifyModel = new HeroIfyModel();\nexport default heroifyModel;"]},"metadata":{},"sourceType":"module"}